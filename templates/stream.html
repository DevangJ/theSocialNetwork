{% extends 'layout.html' %}

{% block content %}
{% for post in stream|reverse %}
  <article>
    <h2>
      <a href="{{ url_for('stream', user_id = post[1]) }}">@{{ username_fetch_by_id(post[1]) }}</a>
    </h2>
    <div class="post">
      <p>
        {% if use == 1 %}
          <blockquote style="white-space: pre-line">{{ post[2] }}</blockquote>
        {% else %}
          {% if post[2]|length > 100 %}
            <blockquote style="white-space: pre-line">{{ post[2][:100] }}...</blockquote>
            <a class="view" href="{{ url_for('view_post', post_id = post[0]) }}">View More</a>
          {% else %}
            <blockquote style="white-space: pre-line">{{ post[2] }}</blockquote>
          {% endif %}
        {% endif %}
        <div>
          <p>
            {% if session['user_id'] not in like_list_by_post_id(post[0])%}
              <a href="{{ url_for('like', post_id = post[0]) }}" class="btn btn-dark btn-sm"><span class="badge badge-light">{{ like_list_by_post_id(post[0])|length }}</span> Like</a>
            {% else %}
              <a href="{{ url_for('unlike', post_id = post[0]) }}" class="btn btn-dark btn-sm"><span class="badge badge-light">{{ like_list_by_post_id(post[0])|length }}</span> Unlike</a>
            {% endif %}
            {% if session['user_id'] == post[1] %}
              <a href="{{ url_for('delete_clicked_post', post_id = post[0]) }}" class="btn btn-dark btn-sm"> Delete</a>
              <a href="{{ url_for('edit_clicked_post', post_id = post[0]) }}" class="btn btn-dark btn-sm"> Edit</a>
            {% endif %}
          </p>
        </div>
      </p>
    </div>
    <p>
      Posted on {{ post[3].strftime('%d-%m-%y') }}
    </p>
  </article>
{% endfor %}
{% endblock %}
